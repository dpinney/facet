<!doctype html>
<html>
<head>
<title></title>
<style>
body { font-family: verdana; margin: .5in;}
li { margin-bottom: 8px }
.small { font-size: smaller }
.green { color:green }
</style>
</head>
<body>

<iframe id="iframe" style="margin-left:20px;width:60%;height:2000px;float:right;" src=""></iframe>

<p>
<b>user</b> &#8226; <a href="group.html">group</a> &#8226; <a href="url.html">url</a> &#8226; <a href="tag.html">tag</a> &#8226; <a href="any.html">any</a>
</p>
<hr>

<div>
<p>
<input id="user"></input> <br><span class="small">(a Hypothesis username)</span>
</p>
<p>
<input size="40" id="token"></input> <br> <span class="small"> (for private annotations, include your <a href="https://hypothes.is/profile/developer">API token</a>)</span> 
</p>
<p>
<input type="button" onclick="_search()" value="documents"></input>
<input type="button" onclick="_really_search()" value="annotations"></input>
</p>
</div>

<div id="export_ux"></div>

<div id="doc"></div>

<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.11.2.min.js"></script><script src="xss.min.js"></script>
<script src="export.js"></script>
<script src="showdown.js"></script>
<script src="utils.js"></script>

<script>
var panel = get_mode();

var user = gup('search');
if ( user != '' )
  document.getElementById('user').value = user;

if ( gup('selections') == '' ) {
  localStorage.setItem('h_export_selections', JSON.stringify([]));
  localStorage.setItem('h_is_selecting','false');
  localStorage.setItem('h_is_exporting','false');
  }

token = getLocalStorageItem('h_token');

function _select() {
  localStorage.setItem('h_is_selecting','true');
  localStorage.setItem('h_is_exporting','false');
  location.href = 'user.html?mode=iframe&search=' + user + '&selections=yes';
}

function _export() {
  localStorage.setItem('h_is_exporting','true');
  localStorage.setItem('h_is_selecting','false');
  load(0, [], []);
}

function _search() {
  localStorage.setItem('h_is_selecting','false');
  user = document.getElementById('user').value;
  token = document.getElementById('token').value;
  localStorage.setItem('h_token', token);
  var href = 'user.html?mode=iframe&search=' + user;
  location.href = href;
}

function _really_search() {
  localStorage.setItem('h_is_selecting','false');
  var user = document.getElementById('user').value;
  token = document.getElementById('token').value;
  localStorage.setItem('h_token', token);
  var href=location.href = 'user.html?mode=search&facet=user' + '&search=' + user;
  location.href = href;
}

var url = panel + '.html?search='+ user + '&facet=user';
if ( gup('selections') != '' ) 
	url += '&selections=yes';
document.getElementById('iframe').setAttribute('src', url);

document.getElementById('token').value = token;

document.title = 'Hypothesis activity for the query user=' + user;

add_export_ux();
//add_doc();

</script>


</body>
</html>
